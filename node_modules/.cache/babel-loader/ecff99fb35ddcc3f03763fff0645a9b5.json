{"ast":null,"code":"var _jsxFileName = \"/Users/jeffymonday/Desktop/meowmeowshop/Frontend/src/contexts/AuthContext.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport { createContext, useContext, useEffect, useState } from 'react';\nimport * as authService from '../api/authApi';\nimport * as userService from '../api/userApi';\nimport { addAccessToken, getAccessToken, removeAccessToken } from '../utils/localStorage';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/createContext();\n\nfunction AuthContextProvider(_ref) {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  const [user, setUser] = useState(null);\n  const [initialLoading, setInitialLoading] = useState(true);\n  useEffect(() => {\n    const fetchMe = async () => {\n      try {\n        if (getAccessToken()) {\n          await getMe();\n        }\n      } catch (err) {// console.log(err);\n      } finally {\n        setInitialLoading(false);\n      }\n    };\n\n    fetchMe();\n  }, []);\n\n  const getMe = async () => {\n    const res = await authService.getMe();\n    setUser(res.data.user);\n  };\n\n  const register = async input => {\n    const res = await authService.register(input);\n    addAccessToken(res.data.token);\n    setTimeout(() => getMe(), 1);\n  };\n\n  const login = async input => {\n    const res = await authService.login(input);\n    addAccessToken(res.data.token);\n    await getMe();\n  };\n\n  const logout = () => {\n    setUser(null);\n    removeAccessToken();\n  };\n\n  const updateUser = async input => {\n    const res = await userService.updateUser(input);\n    setUser(res.data.user);\n  };\n\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      user,\n      register,\n      login,\n      logout,\n      initialLoading,\n      updateUser\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 60,\n    columnNumber: 3\n  }, this);\n}\n\n_s(AuthContextProvider, \"pIUwBflQvYa7sf/zgmtIjVmG2QM=\");\n\n_c = AuthContextProvider;\nexport const useAuth = () => {\n  _s2();\n\n  return useContext(AuthContext);\n};\n\n_s2(useAuth, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n\nexport default AuthContextProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthContextProvider\");","map":{"version":3,"names":["createContext","useContext","useEffect","useState","authService","userService","addAccessToken","getAccessToken","removeAccessToken","AuthContext","AuthContextProvider","children","user","setUser","initialLoading","setInitialLoading","fetchMe","getMe","err","res","data","register","input","token","setTimeout","login","logout","updateUser","useAuth"],"sources":["/Users/jeffymonday/Desktop/meowmeowshop/Frontend/src/contexts/AuthContext.js"],"sourcesContent":["import { createContext, useContext, useEffect, useState } from 'react';\nimport * as authService from '../api/authApi';\nimport * as userService from '../api/userApi';\nimport {\n\taddAccessToken,\n\tgetAccessToken,\n\tremoveAccessToken,\n} from '../utils/localStorage';\n\nconst AuthContext = createContext();\n\nfunction AuthContextProvider({ children }) {\n\tconst [user, setUser] = useState(null);\n\tconst [initialLoading, setInitialLoading] = useState(true);\n\n\tuseEffect(() => {\n\t\tconst fetchMe = async () => {\n\t\t\ttry {\n\t\t\t\tif (getAccessToken()) {\n\t\t\t\t\tawait getMe();\n\t\t\t\t}\n\t\t\t} catch (err) {\n\t\t\t\t// console.log(err);\n\t\t\t} finally {\n\t\t\t\tsetInitialLoading(false);\n\t\t\t}\n\t\t};\n\n\t\tfetchMe();\n\t}, []);\n\n\tconst getMe = async () => {\n\t\tconst res = await authService.getMe();\n\t\tsetUser(res.data.user);\n\t};\n\n\tconst register = async (input) => {\n\t\tconst res = await authService.register(input);\n\t\taddAccessToken(res.data.token);\n\t\tsetTimeout(() => getMe(), 1);\n\t};\n\n\tconst login = async (input) => {\n\t\tconst res = await authService.login(input);\n\t\taddAccessToken(res.data.token);\n\t\tawait getMe();\n\t};\n\n\tconst logout = () => {\n\t\tsetUser(null);\n\t\tremoveAccessToken();\n\t};\n\n\tconst updateUser = async (input) => {\n\t\tconst res = await userService.updateUser(input);\n\t\tsetUser(res.data.user);\n\t};\n\n\treturn (\n\t\t<AuthContext.Provider\n\t\t\tvalue={{ user, register, login, logout, initialLoading, updateUser }}\n\t\t>\n\t\t\t{children}\n\t\t</AuthContext.Provider>\n\t);\n}\n\nexport const useAuth = () => {\n\treturn useContext(AuthContext);\n};\n\nexport default AuthContextProvider;\n"],"mappings":";;;;AAAA,SAASA,aAAT,EAAwBC,UAAxB,EAAoCC,SAApC,EAA+CC,QAA/C,QAA+D,OAA/D;AACA,OAAO,KAAKC,WAAZ,MAA6B,gBAA7B;AACA,OAAO,KAAKC,WAAZ,MAA6B,gBAA7B;AACA,SACCC,cADD,EAECC,cAFD,EAGCC,iBAHD,QAIO,uBAJP;;AAMA,MAAMC,WAAW,gBAAGT,aAAa,EAAjC;;AAEA,SAASU,mBAAT,OAA2C;EAAA;;EAAA,IAAd;IAAEC;EAAF,CAAc;EAC1C,MAAM,CAACC,IAAD,EAAOC,OAAP,IAAkBV,QAAQ,CAAC,IAAD,CAAhC;EACA,MAAM,CAACW,cAAD,EAAiBC,iBAAjB,IAAsCZ,QAAQ,CAAC,IAAD,CAApD;EAEAD,SAAS,CAAC,MAAM;IACf,MAAMc,OAAO,GAAG,YAAY;MAC3B,IAAI;QACH,IAAIT,cAAc,EAAlB,EAAsB;UACrB,MAAMU,KAAK,EAAX;QACA;MACD,CAJD,CAIE,OAAOC,GAAP,EAAY,CACb;MACA,CAND,SAMU;QACTH,iBAAiB,CAAC,KAAD,CAAjB;MACA;IACD,CAVD;;IAYAC,OAAO;EACP,CAdQ,EAcN,EAdM,CAAT;;EAgBA,MAAMC,KAAK,GAAG,YAAY;IACzB,MAAME,GAAG,GAAG,MAAMf,WAAW,CAACa,KAAZ,EAAlB;IACAJ,OAAO,CAACM,GAAG,CAACC,IAAJ,CAASR,IAAV,CAAP;EACA,CAHD;;EAKA,MAAMS,QAAQ,GAAG,MAAOC,KAAP,IAAiB;IACjC,MAAMH,GAAG,GAAG,MAAMf,WAAW,CAACiB,QAAZ,CAAqBC,KAArB,CAAlB;IACAhB,cAAc,CAACa,GAAG,CAACC,IAAJ,CAASG,KAAV,CAAd;IACAC,UAAU,CAAC,MAAMP,KAAK,EAAZ,EAAgB,CAAhB,CAAV;EACA,CAJD;;EAMA,MAAMQ,KAAK,GAAG,MAAOH,KAAP,IAAiB;IAC9B,MAAMH,GAAG,GAAG,MAAMf,WAAW,CAACqB,KAAZ,CAAkBH,KAAlB,CAAlB;IACAhB,cAAc,CAACa,GAAG,CAACC,IAAJ,CAASG,KAAV,CAAd;IACA,MAAMN,KAAK,EAAX;EACA,CAJD;;EAMA,MAAMS,MAAM,GAAG,MAAM;IACpBb,OAAO,CAAC,IAAD,CAAP;IACAL,iBAAiB;EACjB,CAHD;;EAKA,MAAMmB,UAAU,GAAG,MAAOL,KAAP,IAAiB;IACnC,MAAMH,GAAG,GAAG,MAAMd,WAAW,CAACsB,UAAZ,CAAuBL,KAAvB,CAAlB;IACAT,OAAO,CAACM,GAAG,CAACC,IAAJ,CAASR,IAAV,CAAP;EACA,CAHD;;EAKA,oBACC,QAAC,WAAD,CAAa,QAAb;IACC,KAAK,EAAE;MAAEA,IAAF;MAAQS,QAAR;MAAkBI,KAAlB;MAAyBC,MAAzB;MAAiCZ,cAAjC;MAAiDa;IAAjD,CADR;IAAA,UAGEhB;EAHF;IAAA;IAAA;IAAA;EAAA,QADD;AAOA;;GAtDQD,mB;;KAAAA,mB;AAwDT,OAAO,MAAMkB,OAAO,GAAG,MAAM;EAAA;;EAC5B,OAAO3B,UAAU,CAACQ,WAAD,CAAjB;AACA,CAFM;;IAAMmB,O;;AAIb,eAAelB,mBAAf"},"metadata":{},"sourceType":"module"}