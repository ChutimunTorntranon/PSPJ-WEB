{"ast":null,"code":"var _jsxFileName = \"/Users/jeffymonday/Desktop/meowmeowshop/Frontend/src/contexts/AuthContext.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport { createContext, useContext, useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport * as authService from '../api/authApi';\nimport * as userService from '../api/userApi';\nimport { addAccessToken, getAccessToken, removeAccessToken } from '../utils/localStorage';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/createContext();\n\nfunction AuthContextProvider(_ref) {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  const [user, setUser] = useState(null);\n  const Navigate = useNavigate();\n  const [initialLoading, setInitialLoading] = useState(true);\n  useEffect(() => {\n    const fetchMe = async () => {\n      try {\n        if (getAccessToken()) {\n          await getMe();\n        }\n      } catch (err) {\n        console.log(err);\n      } finally {\n        setInitialLoading(false);\n      }\n    };\n\n    fetchMe();\n  }, []);\n\n  const getMe = async () => {\n    const res = await authService.getMe();\n    setUser(res.data.user);\n  };\n\n  const register = async input => {\n    const res = await authService.register(input);\n    Navigate('/login'); // setTimeout(() => setUser(true), 100);\n    // addAccessToken(res.data.token);\n    // setTimeout(() => getMe(), 1);\n  };\n\n  const login = async input => {\n    const res = await authService.login(input);\n    setUser(true);\n    addAccessToken(res.data.token);\n    await getMe();\n    Navigate('/home');\n  };\n\n  const logout = () => {\n    setUser(null);\n    removeAccessToken();\n  };\n\n  const updateUser = async input => {\n    const res = await userService.updateUser(input);\n    setUser(res.data.user);\n  };\n\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      user,\n      register,\n      login,\n      logout,\n      initialLoading,\n      updateUser\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 66,\n    columnNumber: 3\n  }, this);\n}\n\n_s(AuthContextProvider, \"4r8Km8fGcQ8Q15ZBaUAT8Iounq4=\", false, function () {\n  return [useNavigate];\n});\n\n_c = AuthContextProvider;\nexport const useAuth = () => {\n  _s2();\n\n  return useContext(AuthContext);\n};\n\n_s2(useAuth, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n\nexport default AuthContextProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthContextProvider\");","map":{"version":3,"names":["createContext","useContext","useEffect","useState","useNavigate","authService","userService","addAccessToken","getAccessToken","removeAccessToken","AuthContext","AuthContextProvider","children","user","setUser","Navigate","initialLoading","setInitialLoading","fetchMe","getMe","err","console","log","res","data","register","input","login","token","logout","updateUser","useAuth"],"sources":["/Users/jeffymonday/Desktop/meowmeowshop/Frontend/src/contexts/AuthContext.js"],"sourcesContent":["import { createContext, useContext, useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport * as authService from '../api/authApi';\nimport * as userService from '../api/userApi';\nimport {\n\taddAccessToken,\n\tgetAccessToken,\n\tremoveAccessToken,\n} from '../utils/localStorage';\n\nconst AuthContext = createContext();\n\nfunction AuthContextProvider({ children }) {\n\tconst [user, setUser] = useState(null);\n\tconst Navigate = useNavigate();\n\tconst [initialLoading, setInitialLoading] = useState(true);\n\n\tuseEffect(() => {\n\t\tconst fetchMe = async () => {\n\t\t\ttry {\n\t\t\t\tif (getAccessToken()) {\n\t\t\t\t\tawait getMe();\n\t\t\t\t}\n\t\t\t} catch (err) {\n\t\t\t\tconsole.log(err);\n\t\t\t} finally {\n\t\t\t\tsetInitialLoading(false);\n\t\t\t}\n\t\t};\n\n\t\tfetchMe();\n\t}, []);\n\n\tconst getMe = async () => {\n\t\tconst res = await authService.getMe();\n\t\tsetUser(res.data.user);\n\t};\n\n\tconst register = async (input) => {\n\t\tconst res = await authService.register(input);\n\t\tNavigate('/login');\n\t\t// setTimeout(() => setUser(true), 100);\n\t\t// addAccessToken(res.data.token);\n\t\t// setTimeout(() => getMe(), 1);\n\t};\n\n\tconst login = async (input) => {\n\t\tconst res = await authService.login(input);\n\t\tsetUser(true);\n\t\taddAccessToken(res.data.token);\n\t\tawait getMe();\n\t\tNavigate('/home');\n\t};\n\n\tconst logout = () => {\n\t\tsetUser(null);\n\t\tremoveAccessToken();\n\t};\n\n\tconst updateUser = async (input) => {\n\t\tconst res = await userService.updateUser(input);\n\t\tsetUser(res.data.user);\n\t};\n\n\treturn (\n\t\t<AuthContext.Provider\n\t\t\tvalue={{ user, register, login, logout, initialLoading, updateUser }}\n\t\t>\n\t\t\t{children}\n\t\t</AuthContext.Provider>\n\t);\n}\n\nexport const useAuth = () => {\n\treturn useContext(AuthContext);\n};\n\nexport default AuthContextProvider;\n"],"mappings":";;;;AAAA,SAASA,aAAT,EAAwBC,UAAxB,EAAoCC,SAApC,EAA+CC,QAA/C,QAA+D,OAA/D;AACA,SAASC,WAAT,QAA4B,kBAA5B;AACA,OAAO,KAAKC,WAAZ,MAA6B,gBAA7B;AACA,OAAO,KAAKC,WAAZ,MAA6B,gBAA7B;AACA,SACCC,cADD,EAECC,cAFD,EAGCC,iBAHD,QAIO,uBAJP;;AAMA,MAAMC,WAAW,gBAAGV,aAAa,EAAjC;;AAEA,SAASW,mBAAT,OAA2C;EAAA;;EAAA,IAAd;IAAEC;EAAF,CAAc;EAC1C,MAAM,CAACC,IAAD,EAAOC,OAAP,IAAkBX,QAAQ,CAAC,IAAD,CAAhC;EACA,MAAMY,QAAQ,GAAGX,WAAW,EAA5B;EACA,MAAM,CAACY,cAAD,EAAiBC,iBAAjB,IAAsCd,QAAQ,CAAC,IAAD,CAApD;EAEAD,SAAS,CAAC,MAAM;IACf,MAAMgB,OAAO,GAAG,YAAY;MAC3B,IAAI;QACH,IAAIV,cAAc,EAAlB,EAAsB;UACrB,MAAMW,KAAK,EAAX;QACA;MACD,CAJD,CAIE,OAAOC,GAAP,EAAY;QACbC,OAAO,CAACC,GAAR,CAAYF,GAAZ;MACA,CAND,SAMU;QACTH,iBAAiB,CAAC,KAAD,CAAjB;MACA;IACD,CAVD;;IAYAC,OAAO;EACP,CAdQ,EAcN,EAdM,CAAT;;EAgBA,MAAMC,KAAK,GAAG,YAAY;IACzB,MAAMI,GAAG,GAAG,MAAMlB,WAAW,CAACc,KAAZ,EAAlB;IACAL,OAAO,CAACS,GAAG,CAACC,IAAJ,CAASX,IAAV,CAAP;EACA,CAHD;;EAKA,MAAMY,QAAQ,GAAG,MAAOC,KAAP,IAAiB;IACjC,MAAMH,GAAG,GAAG,MAAMlB,WAAW,CAACoB,QAAZ,CAAqBC,KAArB,CAAlB;IACAX,QAAQ,CAAC,QAAD,CAAR,CAFiC,CAGjC;IACA;IACA;EACA,CAND;;EAQA,MAAMY,KAAK,GAAG,MAAOD,KAAP,IAAiB;IAC9B,MAAMH,GAAG,GAAG,MAAMlB,WAAW,CAACsB,KAAZ,CAAkBD,KAAlB,CAAlB;IACAZ,OAAO,CAAC,IAAD,CAAP;IACAP,cAAc,CAACgB,GAAG,CAACC,IAAJ,CAASI,KAAV,CAAd;IACA,MAAMT,KAAK,EAAX;IACAJ,QAAQ,CAAC,OAAD,CAAR;EACA,CAND;;EAQA,MAAMc,MAAM,GAAG,MAAM;IACpBf,OAAO,CAAC,IAAD,CAAP;IACAL,iBAAiB;EACjB,CAHD;;EAKA,MAAMqB,UAAU,GAAG,MAAOJ,KAAP,IAAiB;IACnC,MAAMH,GAAG,GAAG,MAAMjB,WAAW,CAACwB,UAAZ,CAAuBJ,KAAvB,CAAlB;IACAZ,OAAO,CAACS,GAAG,CAACC,IAAJ,CAASX,IAAV,CAAP;EACA,CAHD;;EAKA,oBACC,QAAC,WAAD,CAAa,QAAb;IACC,KAAK,EAAE;MAAEA,IAAF;MAAQY,QAAR;MAAkBE,KAAlB;MAAyBE,MAAzB;MAAiCb,cAAjC;MAAiDc;IAAjD,CADR;IAAA,UAGElB;EAHF;IAAA;IAAA;IAAA;EAAA,QADD;AAOA;;GA3DQD,mB;UAESP,W;;;KAFTO,mB;AA6DT,OAAO,MAAMoB,OAAO,GAAG,MAAM;EAAA;;EAC5B,OAAO9B,UAAU,CAACS,WAAD,CAAjB;AACA,CAFM;;IAAMqB,O;;AAIb,eAAepB,mBAAf"},"metadata":{},"sourceType":"module"}